package com.kindredgroup.commons.vulnerableapp;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.InputStream;
import java.io.Serializable;

public class Desert implements Serializable{

    private static final long serialVersionUID = 1L;
    public String message;
    
    public Desert(String message) {
        this.message = message;
    }

    public static void Deserialize(InputStream stream_in) {
        try{
            //Creating an input stream to reconstruct the object from serialised data
            ObjectInputStream in=new ObjectInputStream(stream_in);
            /* For whitebox testing look for this line */
            Desert desert=(Desert)in.readObject();
            // Showing the data of the serialised object
            System.out.println("The desert: " + desert.message);
            in.close();
            }catch(Exception e){
                System.out.println(e);
                }
            }

    public static void Serialize() {
        try {
            // Creating the object
            Desert desert = new Desert("Message");
            // Creating output stream and writing the serialised object
            FileOutputStream outfile = new FileOutputStream("object.ser");
            ObjectOutputStream outstream = new ObjectOutputStream(outfile);
            outstream.writeObject(desert);
            outstream.flush();
            outstream.close();
            System.out.println("Serialized data saved to object.ser");
        } catch (Exception e) {
            System.out.println(e);
        }
    }
}